var getComments=function(){var n=$(this).attr("data-page");$.ajax({url:"/Comments/GetComments",type:"GET",data:{page:n},success:function(n){$("#CommentListSegment").html(n)},error:function(){alert("Something happened!")}})};$(document).ready(function(){$("#SubmitComment").click(function(){var n=$("#CommentText").val();$.ajax({url:"/Comments/CreateFromPartial",data:{data:n},type:"POST",success:function(){$("#CommentText").val("");getComments()},error:function(){alert("Something happened")}})})});$("#CommentListSegment").on("click",".SwitchPageBtn",getComments);(function(){var i=window.$game={_mode:null},u,f,r,t,e,o,s,h,n;i.save=function(){return{mode:this._mode,dialog:this.dialog.save()}};i.load=function(n){this._mode=n.mode;this.dialog.load(n.dialog);n.mode=="dialog"&&this.dialog.show(!0)};n=i.dialog={_stages:{},_actions:{},_index:0,_stage:null,_busy:!1};n.save=function(){return{index:this._index,stage:this._stage.name,image:t.attr("src"),scene:$U.getBgImage(e),text:f.html(),name:r.html()}};n.load=function(n){this._index=n.index;this._stage=this._stages[n.stage];n.image?(t.attr("src",n.image),t.removeClass("dg-hidden")):t.addClass("dg-hidden");$U.setBgImage(e,n.scene);f.html(n.text);n.name?(r.html(n.name),r.css("display","")):r.css("display","none")};n.setStage=function(n,t){for(var r={},i=0;i<t.length;i++)t[i].id&&(r[t[i].id]=i);this._stages[n]={name:n,data:t.slice(),labels:r}};n.setAction=function(n,t){this._actions[n]=t};n.advance=function(){var n,s,l;if(this._stage&&!this._busy){n:while(n=this._stage.data[this._index]){this._index++;switch(n.do){case"say":f.html(n.text);n.name?(r.css("display",""),r.html(n.name)):r.css("display","none");break n;case"image":var a=t.attr("src"),c=n.url||u,s=$U.always({self:this,url:c});a!=u&&(s=s.then(function(n){return t.addClass("dg-hidden"),$U.delay(500,n)}));c!=u&&(s=s.then(function(n){return t.attr("src",n.url),t.removeClass("dg-hidden"),$U.delay(500,n)}));s.then(function(n){n.self._busy=!1;n.self.advance()});this._busy=!0;break n;case"scene":s=$U.always({url:n.url,self:this});s.then(function(n){return o.addClass("dg-faded"),$U.delay(500,n)}).then(function(n){return o.removeClass("dg-faded"),$U.setBgImage(e,n.url),$U.delay(500,n)}).then(function(n){n.self._busy=!1;n.self.advance()});this._busy=!0;break n;case"goto":this._goto(n.label,n.stage);break;case"action":(l=this._actions[n.name])?l.apply(i,n.args):n.name&&console.error("Invalid action '"+n.name+"'")}}h.css("display",n?"":"none")}};n._goto=function(n,t){var i,r;if(t){if(i=this._stages[t],!i){console.error("Invalid stage '"+t+"'");return}this._stage=i}if(n){if(r=this._stage.labels[n],!r){console.error("Invalid label '"+n+"'");return}this._index=r}else this._index=0};n.goto=function(n,t){this._busy||(this._goto(n,t),this.advance())};n.show=function(n){this._stage&&!this._busy&&(s.css("display",n?"":"none"),n&&i._mode==null?i._mode="dialog":n||i.mode!="dialog"||(i._mode=null))};n.setAction("show",function(){this.dialog.show(!0)});n.setAction("hide",function(){this.dialog.show(!1)});$(document).ready(function(){f=$(".dg-text span.text");r=$(".dg-text span.name");t=$(".dg-image img");e=$(".dialog-scene");o=$(".dialog-fade");s=$(".dialog-box");h=$(".dialog-box a.next-btn");$(".dialog-box a.next-btn").click(function(){n.advance()});$(".game .play-btn").click(function(){$(this).css("display","none");n.goto(null,"intro")});u=t.attr("src");t.addClass("dg-hidden")})}).call(this),function(){var n=window.$U={};n.getBgImage=function(n){var i=$(n).css("background-image"),t=i.match(/url\("(.+)"\)/i);return t&&t[1]?t[1]:null};n.setBgImage=function(n,t){t?(t='url("'+t.replace('"',"%22")+'")',$(n).css("background-image",t)):$(n).css("background-image","none")};n.delay=function(n,t){return $.Deferred(function(i){setTimeout(i.resolve.bind(null,t),n)})};n.always=function(n){return $.Deferred(function(t){t.resolve.call(null,n)})}}.call(this);$(document).ready(function(){$("div.has-bg img").each(function(){var n=$(this);$U.setBgImage(n.parent(),n.attr("src"));n.remove()});var n=$(".fullscreen-btn > a");n.attr("href","javascript:void(0)");n.click(function(){if(document.fullscreenElement||document.webkitFullscreenElement||document.mozFullScreenElement||document.msFullscreenElement)document.exitFullscreen?document.exitFullscreen():document.webkitExitFullscreen?document.webkitExitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.msExitFullscreen&&document.msExitFullscreen();else{var t=$(this).attr("data-target"),n=document.getElementById(t);n.requestFullscreen?n.requestFullscreen():n.mozRequestFullScreen?n.mozRequestFullScreen():n.webkitRequestFullscreen?n.webkitRequestFullscreen():n.msRequestFullscreen&&n.msRequestFullscreen()}})});